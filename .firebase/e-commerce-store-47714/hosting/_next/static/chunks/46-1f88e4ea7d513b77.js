(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{1046:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return en}});var r=s(5893),t=s(7294),n=s(5806),i=s(1163),l=s(9668),d=s(5409),o=s(967),c=s(5150),u=s(120),h=s(1963),m=s.n(h);function x(){let{user:e}=(0,d.a)();return(0,r.jsxs)("div",{className:m().info,children:[(0,r.jsx)(o.Z,{icon:!0,className:m().user,children:(0,r.jsx)(c.Z,{name:"user outline"})}),(0,r.jsx)("h3",{className:m().username,children:e.username}),(0,r.jsx)("h4",{className:m().email,children:e.email}),(0,r.jsxs)("p",{className:m().createdAt,children:["Miembro desde:"," ",u.ou.fromISO(e.createdAt,{locale:"es"}).toFormat("DDD")]})]})}var p=s(5496),j=s(6443),_=s(3370),f=s(6310),v=s(61),g=s.n(v);let b=new _.n5;var C=s(3885),Z=s.n(C);let y=new _.n5;var w=s(7221),N=s.n(w);let I=new _.n5,A={ChangeNameForm:function(){var e,a;let{user:s}=(0,d.a)(),t=(0,j.TA)({initialValues:(e=s.firstname,a=s.lastname,{firstname:e,lastname:a}),validationSchema:f.Ry({firstname:f.Z_().required(!0),lastname:f.Z_().required(!0)}),validateOnChange:!1,onSubmit:async e=>{try{await b.updateMe(s.id,e)}catch(e){console.error(e)}}});return(0,r.jsxs)(p.Z,{onSubmit:t.handleSubmit,children:[(0,r.jsx)("label",{children:"Nombre y apellidos"}),(0,r.jsxs)("div",{className:g().content,children:[(0,r.jsx)(p.Z.Input,{name:"firstname",placeholder:"Nombre",value:t.values.firstname,onChange:t.handleChange,error:t.errors.firstname}),(0,r.jsx)(p.Z.Input,{name:"lastname",placeholder:"Apellidos",value:t.values.lastname,onChange:t.handleChange,error:t.errors.lastname}),(0,r.jsx)(p.Z.Button,{type:"submit",loading:t.isSubmitting,children:"Enviar"})]})]})},ChangeEmailForm:function(){let{user:e,updateUser:a}=(0,d.a)(),s=(0,j.TA)({initialValues:{email:"",repeatEmail:""},validationSchema:f.Ry({email:f.Z_().email(!0).required(!0),repeatEmail:f.Z_().email(!0).required(!0).oneOf([f.iH("email")],!0)}),validateOnChange:!1,onSubmit:async r=>{try{await y.updateMe(e.id,{email:r.email}),a("email",r.email),s.handleReset()}catch(e){console.error(e)}}});return(0,r.jsxs)(p.Z,{onSubmit:s.handleSubmit,className:Z().form,children:[(0,r.jsx)("label",{children:"Cambiar correo electronico"}),(0,r.jsx)(p.Z.Input,{name:"email",placeholder:"Nuevo correo electronico",value:s.values.email,onChange:s.handleChange,error:s.errors.email}),(0,r.jsx)(p.Z.Input,{name:"repeatEmail",placeholder:"Repetir correo electronico",value:s.values.repeatEmail,onChange:s.handleChange,error:s.errors.repeatEmail}),(0,r.jsx)(p.Z.Button,{type:"submit",loading:s.isSubmitting,children:"Enviar"})]})},ChangePasswordForm:function(){let{user:e,logout:a}=(0,d.a)(),s=(0,j.TA)({initialValues:{password:"",repeatPassword:""},validationSchema:f.Ry({password:f.Z_().required(!0),repeatPassword:f.Z_().required(!0).oneOf([f.iH("password")],!0)}),validateOnChange:!1,onSubmit:async s=>{try{await I.updateMe(e.id,{password:s.password}),a()}catch(e){throw e}}});return(0,r.jsxs)(p.Z,{onSubmit:s.handleSubmit,className:N().form,children:[(0,r.jsx)("label",{children:"Cambiar contrase\xf1a"}),(0,r.jsx)(p.Z.Input,{type:"password",name:"password",placeholder:"Nueva contrase\xf1a",value:s.values.password,onChange:s.handleChange,error:s.errors.password}),(0,r.jsx)(p.Z.Input,{type:"password",name:"repeatPassword",placeholder:"Repetir contrase\xf1a",value:s.values.repeatPassword,onChange:s.handleChange,error:s.errors.repeatPassword}),(0,r.jsx)(p.Z.Button,{type:"submit",loading:s.isSubmitting,children:"Enviar"})]})}};var S=s(1861);let q=new _.kL;function E(e){let{onClose:a,onReload:s,addressId:t,address:n}=e,{user:i}=(0,d.a)(),l=(0,j.TA)({initialValues:{title:(null==n?void 0:n.title)||"",name:(null==n?void 0:n.name)||"",address:(null==n?void 0:n.address)||"",city:(null==n?void 0:n.city)||"",state:(null==n?void 0:n.state)||"",postal_code:(null==n?void 0:n.postal_code)||"",phone:(null==n?void 0:n.phone)||""},validationSchema:f.Ry({title:f.Z_().required(!0),name:f.Z_().required(!0),address:f.Z_().required(!0),city:f.Z_().required(!0),state:f.Z_().required(!0),postal_code:f.Z_().required(!0),phone:f.Rx().required(!0)}),validateOnChange:!1,onSubmit:async e=>{try{t?await q.update(e,t):await q.create(e,i.id),l.handleReset(),s(),a()}catch(e){console.error(e)}}});return(0,r.jsxs)(p.Z,{onSubmit:l.handleSubmit,children:[(0,r.jsx)(p.Z.Input,{name:"title",placeholder:"Titulo de la direcci\xf3n",value:l.values.title,onChange:l.handleChange,error:l.errors.title}),(0,r.jsxs)(p.Z.Group,{widths:"equal",children:[(0,r.jsx)(p.Z.Input,{name:"name",placeholder:"Nombre y apellidos",value:l.values.name,onChange:l.handleChange,error:l.errors.name}),(0,r.jsx)(p.Z.Input,{name:"address",placeholder:"Direcci\xf3n",value:l.values.address,onChange:l.handleChange,error:l.errors.address})]}),(0,r.jsxs)(p.Z.Group,{widths:"equal",children:[(0,r.jsx)(p.Z.Input,{name:"state",placeholder:"Provincia",value:l.values.state,onChange:l.handleChange,error:l.errors.state}),(0,r.jsx)(p.Z.Input,{name:"city",placeholder:"Ciudad",value:l.values.city,onChange:l.handleChange,error:l.errors.city})]}),(0,r.jsxs)(p.Z.Group,{widths:"equal",children:[(0,r.jsx)(p.Z.Input,{name:"postal_code",placeholder:"Codigo postal",value:l.values.postal_code,onChange:l.handleChange,error:l.errors.postal_code}),(0,r.jsx)(p.Z.Input,{name:"phone",placeholder:"Telefono",value:l.values.phone,onChange:l.handleChange,error:l.errors.phone})]}),(0,r.jsx)(p.Z.Button,{type:"submit",fluid:!0,loading:l.isSubmitting,children:"Enviar"})]})}var P=s(7657),F=s.n(P),G=s(6486),O=s(2858),R=s.n(O);let k=new _.kL;function M(e){let{addressId:a,address:s,onReload:n}=e,[i,l]=(0,t.useState)(!1),[d,u]=(0,t.useState)(!1),h=()=>l(e=>!e),m=()=>u(e=>!e),x=async()=>{try{await k.delete(a),n()}catch(e){console.error(e)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:R().address,children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:R().title,children:[s.title,": "]}),(0,r.jsxs)("p",{className:R().addressInfo,children:[s.name,", ",s.address,", ",s.state,", ",s.city,","," ",s.postal_code]})]}),(0,r.jsxs)("div",{className:R().actions,children:[(0,r.jsx)(o.Z,{primary:!0,icon:!0,onClick:h,children:(0,r.jsx)(c.Z,{name:"pencil"})}),(0,r.jsx)(o.Z,{primary:!0,icon:!0,onClick:m,children:(0,r.jsx)(c.Z,{name:"delete"})})]})]}),(0,r.jsx)(S.I4,{open:d,onCancel:m,onConfirm:x,content:"\xbfEstas seguro de que quieres eliminar la direcci\xf3n?"}),(0,r.jsx)(S.PA,{show:i,onClose:h,title:"Editar direcci\xf3n",children:(0,r.jsx)(E,{onClose:h,onReload:n,addressId:a,address:s})})]})}var D=s(7141),T=s.n(D);let V=new _.kL,L={AddAddress:function(e){let{onReload:a}=e,[s,n]=(0,t.useState)(!1),i=()=>n(e=>!e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{primary:!0,className:F().addBtn,onClick:i,children:"Crear"}),(0,r.jsx)(S.PA,{show:s,onClose:i,title:"Nueva direcci\xf3n",children:(0,r.jsx)(E,{onClose:i,onReload:a})})]})},AddressForm:E,ListAddresses:function(e){let{reload:a,onReload:s}=e,[n,i]=(0,t.useState)(null),{user:l}=(0,d.a)();return((0,t.useEffect)(()=>{(async()=>{try{let e=await V.getAll(l.id);i(e.data)}catch(e){console.error(e)}})()},[a]),n)?(0,r.jsx)("div",{className:T().addresses,children:(0,G.map)(n,e=>(0,r.jsx)(M,{addressId:e.id,address:e.attributes,onReload:s},e.id))}):null}};var B=s(1664),H=s.n(B),z=s(8040),K=s(1516),Y=s.n(K);function J(e){let{wishlist:a,onReload:s}=e;return(0,r.jsx)("div",{className:Y().gridGames,children:(0,G.map)(a,e=>{let a=e.attributes.game.data,t=a.attributes.cover;return(0,r.jsxs)("div",{className:Y().game,children:[(0,r.jsxs)(H(),{href:"/".concat(a.attributes.slug),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{src:t.attributes.url}),a.attributes.discount>0&&(0,r.jsx)(S.__.Discount,{className:Y().discount,children:"-".concat(a.attributes.discount,"%")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:a.attributes.title}),(0,r.jsxs)("span",{className:Y().price,children:[z.fn.calcDiscountedPrice(a.attributes.price,a.attributes.discount),"€"]})]})]}),(0,r.jsx)(S.X$,{gameId:a.id,className:Y().whislistIcon,removeCallback:s})]},e.id)})})}let U=new _.sq;function X(){let[e,a]=(0,t.useState)(null),[s,n]=(0,t.useState)(!1),{user:i}=(0,d.a)(),l=()=>n(e=>!e);return(0,t.useEffect)(()=>{(async()=>{try{let e=await U.getAll(i.id);a(e)}catch(e){console.error(e)}})()},[s]),0===(0,G.size)(e)?(0,r.jsx)(S.xM,{text:"No tienes ningun juego en la lista de deseos"}):(0,r.jsx)(J,{wishlist:e,onReload:l})}var Q=s(7257),$=s(274),W=s.n($);function ee(e){let a;let{order:s}=e,[n,i]=(0,t.useState)(!1),l=new Date(s.attributes.createdAt).toISOString(),d=s.attributes.products,o=s.attributes.addressShipping,c=()=>i(e=>!e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:W().order,onClick:c,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:u.ou.fromISO(l,{locale:"es"}).toFormat("dd/MM/yyyy")}),(0,r.jsxs)("p",{children:[(a=0,(0,G.forEach)(d,e=>{a+=e.quantity}),a)," productos"]})]}),(0,r.jsxs)("p",{children:[s.attributes.totalPayment.toFixed(2),"€"]})]}),(0,r.jsxs)(S.PA,{show:n,onClose:c,title:"Informaci\xf3n del pedido",children:[(0,G.map)(d,e=>(0,r.jsxs)("div",{className:W().product,children:[(0,r.jsx)(Q.Z,{src:e.attributes.cover}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:W().info,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:e.attributes.title}),(0,r.jsx)("p",{children:e.attributes.platform.data.attributes.title})]})}),(0,r.jsxs)("div",{className:W().quantity,children:[(0,r.jsxs)("span",{children:["x",e.quantity]}),(0,r.jsxs)("span",{children:[z.fn.calcDiscountedPrice(e.attributes.price,e.attributes.discount),"€"]})]})]})]})),(0,r.jsx)("div",{className:W().address,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:W().title,children:o.attributes.title}),(0,r.jsxs)("p",{className:W().addressInfo,children:[o.attributes.name,", ",o.attributes.address,","," ",o.attributes.state,", ",o.attributes.city,","," ",o.attributes.postal_code]})]})}),(0,r.jsx)("div",{className:W().total,children:(0,r.jsxs)("p",{children:["TOTAL: ",s.attributes.totalPayment.toFixed(2),"€"]})})]})]})}let ea=new _.KM;function es(){let[e,a]=(0,t.useState)(null),{user:s}=(0,d.a)();return((0,t.useEffect)(()=>{(async()=>{try{let e=await ea.getAll(s.id);a(e.data)}catch(e){console.error(e)}})()},[]),e)?(0,r.jsx)("div",{children:(0,G.map)(e,e=>(0,r.jsx)(ee,{order:e},e.id))}):(0,r.jsx)(S.xM,{text:"No tienes ningun producto comprado"})}var er=s(7122),et=s.n(er);function en(){let{user:e,logout:a}=(0,d.a)(),s=(0,i.useRouter)(),[o,c]=(0,t.useState)(!1);if(!e)return s.push("/"),null;let u=()=>c(e=>!e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.pQ,{title:"Mi cuenta"}),(0,r.jsxs)(l.iO,{isContainer:!0,relative:!0,children:[(0,r.jsx)(x,{}),(0,r.jsx)(n.Z,{menu:{secondary:!0,pointing:!0},panes:[{menuItem:"Mis pedidos",render:()=>(0,r.jsxs)(n.Z.Pane,{attached:!1,children:[(0,r.jsx)(es,{}),(0,r.jsx)(S.Z0,{height:80})]})},{menuItem:"Lista de deseos",render:()=>(0,r.jsxs)(n.Z.Pane,{attached:!1,children:[(0,r.jsx)(X,{}),(0,r.jsx)(S.Z0,{height:80})]})},{menuItem:"Direcciones",render:()=>(0,r.jsxs)(n.Z.Pane,{attached:!1,children:[(0,r.jsx)(L.AddAddress,{onReload:u}),(0,r.jsx)(L.ListAddresses,{reload:o,onReload:u}),(0,r.jsx)(S.Z0,{height:80})]})},{menuItem:{key:20,icon:"settings",content:"Ajustes"},render:()=>(0,r.jsxs)(n.Z.Pane,{attached:!1,children:[(0,r.jsx)(A.ChangeNameForm,{}),(0,r.jsxs)("div",{className:et().containerForms,children:[(0,r.jsx)(A.ChangeEmailForm,{}),(0,r.jsx)(A.ChangePasswordForm,{})]}),(0,r.jsx)(S.Z0,{height:80})]},99)},{menuItem:{key:21,icon:"log out",content:"",onClick:a}}],className:et().tabs})]})]})}},7657:function(e){e.exports={addBtn:"AddAddress_addBtn__4aGMP"}},2858:function(e){e.exports={address:"Address_address__HJCjf",title:"Address_title__eAVjG",addressInfo:"Address_addressInfo__uhDK7",actions:"Address_actions__wV7iU"}},7141:function(e){e.exports={addresses:"ListAddresses_addresses__q54jt"}},1963:function(e){e.exports={info:"Info_info__YPRNw",user:"Info_user__AG_Tu",username:"Info_username__jCV2a",email:"Info_email__86jmO",createdAt:"Info_createdAt__ATLKK"}},274:function(e){e.exports={order:"Order_order__ofvlw",product:"Order_product__ezRJN",info:"Order_info__kRMDh",quantity:"Order_quantity__YGZz1",address:"Order_address__ZbVq4",title:"Order_title__p3m8s",addressInfo:"Order_addressInfo__DkEm5",total:"Order_total__vaeRO"}},3885:function(e){e.exports={form:"ChangeEmailForm_form__zEArZ"}},61:function(e){e.exports={content:"ChangeNameForm_content__mIlGy"}},7221:function(e){e.exports={form:"ChangePasswordForm_form__DbHhu"}},1516:function(e){e.exports={gridGames:"GridGames_gridGames__6XSM4",game:"GridGames_game__CEaZ4",discount:"GridGames_discount__1pDfr",price:"GridGames_price__VHwbN",whislistIcon:"GridGames_whislistIcon__3Uraj"}},7122:function(e){e.exports={tabs:"account_tabs__0YvVj",containerForms:"account_containerForms__9MZIr"}}}]);